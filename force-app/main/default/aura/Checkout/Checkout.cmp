<aura:component implements="forceCommunity:availableForAllPageTypes" controller="CheckoutHelperApexController">
    <aura:attribute name="couponInput" type="String" default="invalid code" />
    <aura:attribute name="insertCouponSection" type="boolean" default="false" />
    <aura:attribute name="invalidCoupon" type="boolean" default="false" />
    <aura:attribute name="finalPrice" type="String" />
    <aura:attribute name="couponPrice" type="String" />
    <aura:attribute name = 'iter' type = 'List' default = '["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
                                                           "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]' />
    
    <aura:attribute name="parent" type="Aura.Component" default="OrderSPA" required="true" /> 
	<aura:registerEvent name="bubblingEvent" type="c:OrderSPANotifierEvent"/> 
    <aura:method name="applyCoupon" action="{!c.reducedPrice}"/>
    <aura:method name="checkoutStuff" action="{!c.doInitStuff}"/>
    
        
<!-- table that shows all the pizzas in the cart and their toppings and price-->
        <div>
            <table class="tableStyle">
                <tr>
                    <th style = 'width: 25%; text-align: center; font-weight: Bold;'>Order Item</th>
            		<th style = 'width: 25%; text-align: center; font-weight: Bold;'>Pizza Size</th>
                    <th style = 'width: 25%; text-align: center; font-weight: Bold;'>Toppings</th>
                    <th style = 'width: 25%; text-align: center; font-weight: Bold;'>Price</th>
                </tr>
            </table>
            <table class="tableStyle">
                <aura:iteration items = '{!v.iter}' var = 'item'>
                    <tr id="{!'cRow' + item}" style="display: none;">
                        <td id="{!'cNumber' + item}"></td>
                        
                        <td id = "{!'cSize' + item}"></td>
                        
                    	<td id = "{!'cToppings' + item}"></td>
                        
                        <td id = "{!'cPrice' + item}"></td>
                        
                        <!--<td>
                            <lightning:outputField fieldName="myPizza.Price__c" />
                        </td> -->
                    </tr>
                </aura:iteration>
                
            </table>
        </div>
    
        
        <!-- total cost and coupon section-->
        
        
        <div class="slds-align_absolute-center">
            <p class="textResize" id="TotalPrice">
            </p>
        </div>
        
        
        <!-- coupon disount section -->
        
        
        <div class="slds-align_absolute-center">
            <p class="textResize">Have a coupon code? Use it today! 
            <lightning:input aura:id="userInput" name="userInput" label="Enter Your Coupon Code Here!"/>
            </p>
        </div>
        
        <div class="slds-align_absolute-center">
        	<lightning:button class="couponButton" variant="brand-Outline" label="Check Code" onclick="{!c.checkUserInput}" />
        </div>
        
        
<!-- this section only appears if the user has inserted a coupon code -->
        
        <!-- valid coupon code section -->
        <aura:if isTrue="{!v.insertCouponSection}">
        	<div class="slds-align_absolute-center">
                <p class="textResize">Congrats, you get your amazing order at an even lower price! </p>
            </div>     
                
            <div class="slds-align_absolute-center">
                Your new price: 
				<p id ="CouponPrice"></p>
            </div>
        </aura:if>
        
        <!-- Invalid coupon code section -->
        <aura:if isTrue="{!v.invalidCoupon}">
        	<div class="slds-align_absolute-center">
                <p class="textResize">I'm sorry, that code is invalid.</p>
            </div>
        </aura:if>
        
        
<!-- Navigation buttons that appear below the table --> 
        
        
        <div class="slds-align_absolute-center" style="height:5rem">
            <lightning:button class="button-background" variant="brand-Outline" label="View Cart" onclick="{!c.viewCart}" />&nbsp;&nbsp;&nbsp;&nbsp;
            <lightning:button class="button-background" variant="brand-outline" label="Add Another Pizza" onclick="{!c.showPizzaPage}" /> &nbsp;&nbsp;&nbsp;&nbsp;
            <lightning:button variant="brand" label="Purchase" onclick="{!c.purchaseOrder}" />
        </div>


</aura:component>